# kitchen
kitchen_package:
  input_boolean:
    food_waste_machine_state:
      name: Food waste machine state
    dish_washer_state:
      name: Dish washer state
    co2_unhealthy_state:
      name: CO2 unhealthy state

  automation:
    - id: "kitchen_light_off_with_no_motion"
      alias: "kitchen light off with no motion"
      trigger:
        - platform: state
          entity_id: binary_sensor.smartthings_kitchen_motion_occupancy
          to: "off"
          for:
            minutes: 2
      condition:
        - condition: and
          conditions:
            - condition: state
              entity_id: alarm_control_panel.home_monitoring
              state: "armed_night"
            - condition: state
              entity_id: light.hej_3gang_kitchen_light_left_center
              state: "on"
      action:
        - service: light.turn_off
          entity_id: light.hej_3gang_kitchen_light_left_center

    - id: "kitchen_light_on_with_motion_when_sun_is_below_horizon"
      alias: "kitchen light on with motion when sun is below_horizon"
      trigger:
        - platform: state
          entity_id: binary_sensor.smartthings_kitchen_motion_occupancy
          to: "on"
      condition:
        - condition: and
          conditions:
            - condition: state
              entity_id: sun.sun
              state: "below_horizon"
            - condition: state
              entity_id: light.hej_3gang_kitchen_light_left_center
              state: "off"
            - condition: state
              entity_id: light.hej_3gang_kitchen_light_left_top
              state: "off"
            - condition: state
              entity_id: light.hej_3gang_kitchen_light_right_center
              state: "off"
            - condition: state
              entity_id: light.hej_3gang_kitchen_light_right_top
              state: "off"
      action:
        - service: light.turn_on
          entity_id: light.hej_3gang_kitchen_light_left_center

    - id: "notification_when_kitchen_cooker_is_on_and_pantry_door_is_closed"
      alias: "notification when kitchen cooker is on and pantry door is closed"
      trigger:
        - platform: state
          entity_id: binary_sensor.aqara_kitchen_pantry_door_right_contact
          to: "off"
        - platform: state
          entity_id: switch.dawon_kitchen_cooker_plug
          to: "on"
      condition:
        - condition: and
          conditions:
            - condition: state
              entity_id: binary_sensor.aqara_kitchen_pantry_door_right_contact
              state: "off"
            - condition: state
              entity_id: switch.dawon_kitchen_cooker_plug
              state: "on"
      action:
        - service: notify.notify_telegram
          data:
            message: "밥솥이 켜져 있습니다. 팬트리 문을 열어주세요."
        - condition: state
          entity_id: alarm_control_panel.home_monitoring
          state: "disarmed"
        - service: notify.galaxy_cloud_speak
          data:
            message: "밥솥이 켜져 있습니다. 팬트리 문을 열어주세요."

    - id: "kitchen_pantry_light_on_when_door_is_open"
      alias: "kitchen pantry light on when door is open"
      trigger:
        - platform: state
          entity_id: binary_sensor.aqara_kitchen_pantry_door_left_contact
          to: "on"
        - platform: state
          entity_id: binary_sensor.aqara_kitchen_pantry_door_right_contact
          to: "on"
      condition:
        - condition: state
          entity_id: light.hej_3gang_kitchen_light_right_top
          state: "off"
      action:
        - service: light.turn_on
          entity_id: light.hej_3gang_kitchen_light_right_top

    - id: "kitchen_pantry_light_off_when_door_is_closed"
      alias: "kitchen pantry light off when door is closed"
      trigger:
        - platform: state
          entity_id: binary_sensor.aqara_kitchen_pantry_door_left_contact
          to: "off"
        - platform: state
          entity_id: binary_sensor.aqara_kitchen_pantry_door_right_contact
          to: "off"
      condition:
        - condition: and
          conditions:
            - condition: state
              entity_id: light.hej_3gang_kitchen_light_right_top
              state: "on"
            - condition: state
              entity_id: binary_sensor.aqara_kitchen_pantry_door_left_contact
              state: "off"
            - condition: state
              entity_id: binary_sensor.aqara_kitchen_pantry_door_right_contact
              state: "off"
      action:
        - service: light.turn_off
          entity_id: light.hej_3gang_kitchen_light_right_top

    - id: "co2_level_has_reached_unhealthy_state"
      alias: "CO2 level has reached unhealthy state"
      trigger:
        - platform: numeric_state
          entity_id: sensor.samseong_eeomoniteo_carbon_dioxide_measurement
          for: "00:10:00"
          above: 1400
          #below: 9999 # wrong reporting value from sensor
      action:
        - service: input_boolean.turn_on
          entity_id: input_boolean.co2_unhealthy_state
        - service: notify.notify_telegram
          data:
            title: "⚠️ 실내 이산화탄소 수치 관리 필요"
            message: "창문을 열어 환기하세요"
        - condition: state
          entity_id: alarm_control_panel.home_monitoring
          state: "disarmed"
        - service: notify.galaxy_cloud_speak
          data:
            message: "실내 이산화탄소 농도가 너무 높습니다. 환기가 필요합니다."
    - id: "co2_level_has_come_back_to_normal"
      alias: "CO2 level has come back to normal"
      trigger:
        - platform: numeric_state
          entity_id: sensor.samseong_eeomoniteo_carbon_dioxide_measurement
          for: "00:03:00"
          below: 1000
      condition:
        - condition: state
          entity_id: input_boolean.co2_unhealthy_state
          state: "on"
      action:
        - service: input_boolean.turn_off
          entity_id: input_boolean.co2_unhealthy_state
        - service: notify.notify_telegram
          data:
            title: "✅ 실내 이산화탄소 수치 정상"
            message: "이제 창문을 닫아도 좋습니다."
        - condition: state
          entity_id: alarm_control_panel.home_monitoring
          state: "disarmed"
        - service: notify.galaxy_cloud_speak
          data:
            message: "이산화탄소 농도가 정상으로 돌아왔습니다."

    - id: "nutritional_supplements_reminder"
      alias: "Nutritional supplements reminder"
      trigger:
        - platform: time
          at: "12:40:00"
      condition:
        - condition: state
          entity_id: alarm_control_panel.home_monitoring
          state: "disarmed"
      action:
        - service: notify.notify_telegram
          data:
            message: "💊 영양제 알림. 잊지 말고 드세요."
        - condition: state
          entity_id: alarm_control_panel.home_monitoring
          state: "disarmed"
        - service: notify.galaxy_cloud_speak
          data:
            message: "영양제 먹을 시간입니다. 잊지 말고 드세요."
